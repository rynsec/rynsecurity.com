---
const isTR  = Astro.url.pathname.startsWith('/tr');
const label = isTR ? 'Tema' : 'Theme';
---

<button id="theme-toggle"
        class="ml-4 p-2 rounded-full hover:bg-surface transition"
        aria-label={label}>
  <!-- Ä°lk ikon: ay (ðŸŒ™) -->
  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
       fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
  </svg>
</button>

<script is:inline>
  const btn  = document.getElementById('theme-toggle');
  const root = document.documentElement;

  const sun = `<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none"
                     viewBox="0 0 24 24" stroke="currentColor">
    <circle cx="12" cy="12" r="5" stroke-width="2"/>
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M12 1v2m0 18v2m11-11h-2M3 12H1m16.95 6.95l-1.41-1.41M6.46 6.46L5.05 5.05m0 13.9l1.41-1.41m11.48-11.48l1.41 1.41"/>
  </svg>`;

  const moon = `<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none"
                      viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
  </svg>`;

  function apply(theme) {
    if (theme === 'dark') {
      root.classList.add('dark');
      btn.innerHTML = sun;
    } else {
      root.classList.remove('dark');
      btn.innerHTML = moon;
    }
    localStorage.setItem('theme', theme);
  }

  // Ä°lk yÃ¼kleniÅŸte uygula
  apply(
    localStorage.getItem('theme') ??
    (matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
  );

  // TÄ±klama ile geÃ§iÅŸ
  btn.addEventListener('click', () => {
    apply(root.classList.contains('dark') ? 'light' : 'dark');
  });
</script>
